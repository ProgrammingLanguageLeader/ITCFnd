<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">

    <script src="reddit.js"></script>
    <title>Homework 1</title>
</head>
<body>
    <div id="loader"></div>
    <div id="posts"></div>
    <script type="text/javascript">
        const refreshTime = 10000;

        let timer = setTimeout( function tick() {
            let posts = fetchPosts();
            let divPosts = document.getElementById('posts');
            let loader = document.getElementById('loader');

            posts.then(posts => {
                loader.style.display = 'block';
                let postsHTML = '';
                posts.map( (post) => {
                    let title = post.data.title;
                    let permalink = post.data.permalink;
                    let thumbnail = post.data.thumbnail;
                    let card;
                    if (thumbnail != 'default') {
                        card =
                        `<div class="post-with-thumbnail">
                            <img src="${thumbnail}" alt="There must be an image">
                            <a href="https://reddit.com/${permalink}">
                                <p>${title}</p>
                            </a>
                        </div>`;
                    } else {
                        card = `
                        <div class="post-without-thumbnail">
                            <a href="https://reddit.com/${permalink}">
                                <p>${title}</p>
                            </a>
                        </div>`;
                    }
                    postsHTML += card;
                });
                divPosts.innerHTML = postsHTML;
                loader.style.display = 'none';
            });
            timer = setTimeout(tick, refreshTime);
        }, 0);
    </script>
</body>
</html>
